# –ò–º–ø–æ—Ä—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å—é, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –¥–∞—Ç–∞–º–∏
import asyncio          # –î–ª—è –∑–∞–ø—É—Å–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
import logging          # –î–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–∑–∞–ø–∏—Å–∏ –æ—à–∏–±–æ–∫ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)
from datetime import datetime, timedelta  # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º

# –ò–º–ø–æ—Ä—Ç—ã –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ aiogram –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram Bot API
from aiogram import Bot, Dispatcher, F  # Bot - –±–æ—Ç, Dispatcher - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π, F - —Ñ–∏–ª—å—Ç—Ä—ã
from aiogram.filters import CommandStart  # –§–∏–ª—å—Ç—Ä –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /start
from aiogram.fsm.context import FSMContext  # –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è FSM (–º–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π)
from aiogram.fsm.storage.memory import MemoryStorage  # –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ –ø–∞–º—è—Ç–∏
from aiogram.exceptions import TelegramConflictError  # –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤
from aiogram.types import (
    Message,              # –¢–∏–ø –¥–ª—è –æ–±—ã—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    InlineKeyboardMarkup, # –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å inline –∫–Ω–æ–ø–∫–∞–º–∏ (–ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º)
    InlineKeyboardButton, # –ö–Ω–æ–ø–∫–∞ inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    CallbackQuery,        # –¢–∏–ø –¥–ª—è –Ω–∞–∂–∞—Ç–∏–π –Ω–∞ inline –∫–Ω–æ–ø–∫–∏
    ReplyKeyboardMarkup,  # –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ (–≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞)
    KeyboardButton,      # –ö–Ω–æ–ø–∫–∞ reply –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
)

# –ò–º–ø–æ—Ä—Ç—ã –∏–∑ –Ω–∞—à–∏—Ö –º–æ–¥—É–ª–µ–π
from states import Booking, Support  # –°–æ—Å—Ç–æ—è–Ω–∏—è FSM –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
from db import init_db, add_booking, is_pc_available, get_last_booking, delete_booking, get_user_bookings, update_booking_api_id  # –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
from api_client import ClubAPI  # –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–ª—É–±–∞
from config import API_BASE_URL, API_USERNAME, API_PASSWORD, API_BRANCH_ID, API_REGISTER_ID  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API

# –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
TOKEN = "8276794506:AAEqmgZHNn8f-d33dki3XWhPCa0JXF7k3ck"  # –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
ADMIN_ID = 7545686154  # ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ Telegram (–ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)

# –°—Å—ã–ª–∫–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ "–°—Å—ã–ª–∫–∏"
VK_GROUP_LINK = "https://vk.com/cyberzona_rnd"  # –°—Å—ã–ª–∫–∞ –Ω–∞ –≥—Ä—É–ø–ø—É –í–ö
MOBILE_APP_LINK = "https://cyberzona.parazey.com/"  # –°—Å—ã–ª–∫–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
TOURNAMENT_CHAT_LINK = "https://t.me/tournament_cz"  # –°—Å—ã–ª–∫–∞ –Ω–∞ —á–∞—Ç —Ç—É—Ä–Ω–∏—Ä–æ–≤

# –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–æ–º
bot = Bot(token=TOKEN)

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
# MemoryStorage - —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM –≤ –ø–∞–º—è—Ç–∏ (–ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–µ—Ä—è—é—Ç—Å—è)
dp = Dispatcher(storage=MemoryStorage())

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–ª—É–±–∞
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –º–µ–∂–¥—É –±–æ—Ç–æ–º –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
api_client = ClubAPI(
    base_url=API_BASE_URL,      # URL API (–∏–∑ config.py)
    username=API_USERNAME,      # –õ–æ–≥–∏–Ω –¥–ª—è API (–∏–∑ config.py)
    password=API_PASSWORD,      # –ü–∞—Ä–æ–ª—å –¥–ª—è API (–∏–∑ config.py)
    branch_id=API_BRANCH_ID,    # ID —Ñ–∏–ª–∏–∞–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –∏–∑ config.py)
    register_id=API_REGISTER_ID # ID —Ä–µ–≥–∏—Å—Ç—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –∏–∑ config.py)
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)  # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: INFO (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)
logger = logging.getLogger(__name__)  # –°–æ–∑–¥–∞–µ–º –ª–æ–≥–≥–µ—Ä –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è


async def send_to_admin(text: str):
    """
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.
    
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ:
    - –°–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –±—Ä–æ–Ω–∏
    - –û—Ç–º–µ–Ω–µ –±—Ä–æ–Ω–∏
    - –°–æ–æ–±—â–µ–Ω–∏—è—Ö –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
    
    Args:
        text: –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    """
    try:
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –ø–æ –µ–≥–æ ID
        await bot.send_message(ADMIN_ID, text)
        logger.info(f"–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É (ID: {ADMIN_ID})")
    except Exception as e:
        # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å (–∞–¥–º–∏–Ω –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID –∏ —Ç.–¥.)
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É: {e}")
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É: {e}")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞ (/start) –∏ ID –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.")


@dp.message(CommandStart())
async def start(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É /start –∏–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤–ø–µ—Ä–≤—ã–µ.
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏.
    
    Args:
        message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    await message.answer(
        "üéÆ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π –∫–ª—É–±!\n\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
        reply_markup=main_menu()  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏
    )


def main_menu():
    """
    –°–æ–∑–¥–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏.
    
    ReplyKeyboardMarkup - –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞.
    –ö–∞–∂–¥—ã–π —Å–ø–∏—Å–æ–∫ –≤ keyboard - —ç—Ç–æ —Ä—è–¥ –∫–Ω–æ–ø–æ–∫.
    
    Returns:
        ReplyKeyboardMarkup: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –≥–ª–∞–≤–Ω—ã–º –º–µ–Ω—é
    """
    return ReplyKeyboardMarkup(
        keyboard=[
            # –ü–µ—Ä–≤—ã–π —Ä—è–¥: –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ü–ö"
            [KeyboardButton(text="üéÆ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ü–ö")],
            # –í—Ç–æ—Ä–æ–π —Ä—è–¥: –¥–≤–µ –∫–Ω–æ–ø–∫–∏ —Ä—è–¥–æ–º
            [KeyboardButton(text="üìã –ú–æ–∏ –±—Ä–æ–Ω–∏"), KeyboardButton(text="‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å")],
            # –¢—Ä–µ—Ç–∏–π —Ä—è–¥: –æ–¥–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"
            [KeyboardButton(text="üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞")],
            # –ß–µ—Ç–≤–µ—Ä—Ç—ã–π —Ä—è–¥: –¥–≤–µ –∫–Ω–æ–ø–∫–∏ —Ä—è–¥–æ–º
            [KeyboardButton(text="‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"), KeyboardButton(text="üîó –°—Å—ã–ª–∫–∏")]
        ],
        resize_keyboard=True  # –ö–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø–æ–¥ —Ä–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞
    )


def info_menu():
    """
    –°–æ–∑–¥–∞–µ—Ç –º–µ–Ω—é —Ä–∞–∑–¥–µ–ª–∞ "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è".
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è".
    
    Returns:
        ReplyKeyboardMarkup: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –º–µ–Ω—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    """
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üí∞ –ü—Ä–∞–π—Å-–ª–∏—Å—Ç")],  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ü–µ–Ω
            [KeyboardButton(text="üéÅ –ê–∫—Ü–∏–∏ –∏ –±–æ–Ω—É—Å—ã")],  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∞–∫—Ü–∏–π
            [KeyboardButton(text="üèÜ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤")],  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Ç—É—Ä–Ω–∏—Ä–æ–≤
            [KeyboardButton(text="üìú –ü—Ä–∞–≤–∏–ª–∞ –∫–ª—É–±–∞")],  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–∞–≤–∏–ª
            [KeyboardButton(text="‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é")]  # –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
        ],
        resize_keyboard=True
    )


def links_menu():
    """
    –°–æ–∑–¥–∞–µ—Ç –º–µ–Ω—é —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ (inline –∫–Ω–æ–ø–∫–∏).
    
    InlineKeyboardMarkup - –∫–Ω–æ–ø–∫–∏ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º (–Ω–µ –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞).
    –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç —Å—Å—ã–ª–∫–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
    
    Returns:
        InlineKeyboardMarkup: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏
    """
    return InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üîµ –ì—Ä—É–ø–ø–∞ –í–ö", url=VK_GROUP_LINK)],  # –ö–Ω–æ–ø–∫–∞ —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –í–ö
        [InlineKeyboardButton(text="üì± –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ", url=MOBILE_APP_LINK)],  # –ö–Ω–æ–ø–∫–∞ —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        [InlineKeyboardButton(text="üéÆ –ß–∞—Ç –¥–ª—è —Ç—É—Ä–Ω–∏—Ä–æ–≤", url=TOURNAMENT_CHAT_LINK)]  # –ö–Ω–æ–ø–∫–∞ —Å–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ —á–∞—Ç
    ])


def pc_keyboard():
    """
    –°–æ–∑–¥–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ –ü–ö (1-26).
    
    –ö–Ω–æ–ø–∫–∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –ø–æ 3 –≤ —Ä—è–¥ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞.
    –ù–∞–ø—Ä–∏–º–µ—Ä: [–ü–ö 1] [–ü–ö 2] [–ü–ö 3]
             [–ü–ö 4] [–ü–ö 5] [–ü–ö 6]
             ...
    
    Returns:
        ReplyKeyboardMarkup: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ü–ö 1-26
    """
    # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–Ω–æ–ø–æ–∫: –ü–ö 1, –ü–ö 2, ..., –ü–ö 26
    buttons = [KeyboardButton(text=f"–ü–ö {i}") for i in range(1, 27)]
    # –†–∞–∑–±–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞ —Ä—è–¥—ã –ø–æ 3 —à—Ç—É–∫–∏
    # [buttons[0:3], buttons[3:6], buttons[6:9], ...]
    keyboard = [buttons[i:i + 3] for i in range(0, len(buttons), 3)]
    return ReplyKeyboardMarkup(keyboard=keyboard, resize_keyboard=True)


def time_keyboard():
    """
    –°–æ–∑–¥–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏.
    
    –í—Ä–µ–º—è –æ—Ç 00:30 –¥–æ 23:59 —Å —à–∞–≥–æ–º 30 –º–∏–Ω—É—Ç.
    –ö–Ω–æ–ø–∫–∏ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –ø–æ 3 –≤ —Ä—è–¥.
    
    Returns:
        ReplyKeyboardMarkup: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏
    """
    # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
    times = [
        "00:30", "01:00", "01:30", "02:00", "02:30", "03:00", "03:30", "04:00", "04:30",
        "05:00", "05:30", "06:00", "06:30", "07:00", "07:30", "08:00", "08:30",
        "09:00", "09:30", "10:00", "10:30", "11:00", "11:30", "12:00", "12:30",
        "13:00", "13:30", "14:00", "14:30", "15:00", "15:30", "16:00", "16:30",
        "17:00", "17:30", "18:00", "18:30", "19:00", "19:30", "20:00", "20:30",
        "21:00", "21:30", "22:00", "22:30", "23:00", "23:30", "23:59"
    ]
    # –†–∞–∑–±–∏–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–∞ –Ω–∞ —Ä—è–¥—ã –ø–æ 3 —à—Ç—É–∫–∏
    keyboard = [[KeyboardButton(text=t) for t in times[i:i + 3]] for i in range(0, len(times), 3)]
    return ReplyKeyboardMarkup(keyboard=keyboard, resize_keyboard=True)


def duration_keyboard():
    """
    –°–æ–∑–¥–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
    
    Returns:
        ReplyKeyboardMarkup: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    """
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="1 —á–∞—Å"), KeyboardButton(text="3 —á–∞—Å–∞")],  # –ü–µ—Ä–≤—ã–π —Ä—è–¥: 1 –∏ 3 —á–∞—Å–∞
            [KeyboardButton(text="5 —á–∞—Å–æ–≤")],  # –í—Ç–æ—Ä–æ–π —Ä—è–¥: 5 —á–∞—Å–æ–≤
            [KeyboardButton(text="7 —á–∞—Å–æ–≤")],  # –¢—Ä–µ—Ç–∏–π —Ä—è–¥: 7 —á–∞—Å–æ–≤
            [KeyboardButton(text="10 —á–∞—Å–æ–≤")]  # –ß–µ—Ç–≤–µ—Ä—Ç—ã–π —Ä—è–¥: 10 —á–∞—Å–æ–≤
        ],
        resize_keyboard=True
    )


@dp.message(F.text == "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å")
async def cancel_booking(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–º–µ–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–µ–π –±—Ä–æ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
    –£–¥–∞–ª—è–µ—Ç –±—Ä–æ–Ω—å –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î –∏ –∏–∑ API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–ª—É–±–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å api_booking_id).
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å"
    """
    # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –±—Ä–æ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
    booking = await get_last_booking(message.from_user.id)

    # –ï—Å–ª–∏ –±—Ä–æ–Ω–µ–π –Ω–µ—Ç - —Å–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    if not booking:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –±—Ä–æ–Ω–µ–π")
        return

    # –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –±—Ä–æ–Ω–∏: id, –Ω–æ–º–µ—Ä –ü–ö, –¥–∞—Ç–∞, –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞, –≤—Ä–µ–º—è –∫–æ–Ω—Ü–∞, api_booking_id
    booking_id, pc, date, time_from, time_to, api_booking_id = booking

    # –ï—Å–ª–∏ –µ—Å—Ç—å api_booking_id - —É–¥–∞–ª—è–µ–º –±—Ä–æ–Ω—å –∏–∑ API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–ª—É–±–∞
    if api_booking_id:
        try:
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º DELETE –∑–∞–ø—Ä–æ—Å –≤ API
            success = await api_client.delete_booking(api_booking_id)
            if success:
                logger.info(f"–ë—Ä–æ–Ω—å {api_booking_id} —É–¥–∞–ª–µ–Ω–∞ –∏–∑ API")
            else:
                logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –±—Ä–æ–Ω—å {api_booking_id} –∏–∑ API")
        except Exception as e:
            # –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–∑ API - –ª–æ–≥–∏—Ä—É–µ–º, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –±—Ä–æ–Ω–∏ –∏–∑ API: {e}")

    # –£–¥–∞–ª—è–µ–º –±—Ä–æ–Ω—å –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
    await delete_booking(booking_id)

    # –°–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–º–µ–Ω–µ
    await message.answer(
        "‚úÖ –ë—Ä–æ–Ω—å –æ—Ç–º–µ–Ω–µ–Ω–∞:\n\n"
        f"–ü–ö: {pc}\n"
        f"–î–∞—Ç–∞: {date}\n"
        f"–í—Ä–µ–º—è: {time_from} ‚Äì {time_to}",
        reply_markup=main_menu()  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    )

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –æ–± –æ—Ç–º–µ–Ω–µ –±—Ä–æ–Ω–∏
    await send_to_admin(
        "‚ùå –ë—Ä–æ–Ω—å –æ—Ç–º–µ–Ω–µ–Ω–∞!\n\n"
        f"üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @{message.from_user.username or message.from_user.full_name}\n"
        f"üñ• –ü–ö: {pc}\n"
        f"üìÖ –î–∞—Ç–∞: {date}\n"
        f"‚è∞ –í—Ä–µ–º—è: {time_from} ‚Äì {time_to}"
    )


@dp.message(F.text == "üéÆ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ü–ö")
async def booking_start(message: Message, state: FSMContext):
    """
    –ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
    
    –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM –≤ Booking.pc (–≤—ã–±–æ—Ä –ü–ö).
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –ü–ö 1-26.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üéÆ –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ü–ö"
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    """
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM: —Ç–µ–ø–µ—Ä—å –±–æ—Ç –æ–∂–∏–¥–∞–µ—Ç –≤—ã–±–æ—Ä –ü–ö
    await state.set_state(Booking.pc)
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –ü–ö 1-26
    await message.answer("üéÆ –í—ã–±–µ—Ä–∏—Ç–µ –ü–ö:", reply_markup=pc_keyboard())


@dp.message(Booking.pc)
async def booking_pc(message: Message, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –ü–ö.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ Booking.pc –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ –ü–ö, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–º–µ—Ä –ü–ö –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –≤—ã–±–æ—Ä—É –¥–∞—Ç—ã.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "–ü–ö 1", "–ü–ö 2" –∏ —Ç.–¥.)
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –ü–ö –∫–Ω–æ–ø–∫–æ–π (—Ç–µ–∫—Å—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å "–ü–ö")
    if not message.text.startswith("–ü–ö"):
        await message.answer("‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –ü–ö –∫–Ω–æ–ø–∫–æ–π")
        return

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –Ω–æ–º–µ—Ä –ü–ö –∏–∑ —Ç–µ–∫—Å—Ç–∞ ("–ü–ö 5" -> 5)
    pc_number = int(message.text.replace("–ü–ö ", ""))
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–º–µ—Ä –ü–ö –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM
    await state.update_data(pc=pc_number)
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É - –≤—ã–±–æ—Ä –¥–∞—Ç—ã
    await state.set_state(Booking.date)

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–æ–π "–°–µ–≥–æ–¥–Ω—è" –∏ –ø—Ä–æ—Å–∏–º –≤–≤–µ—Å—Ç–∏ –¥–∞—Ç—É
    await message.answer(
        "–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: 2025-01-10) –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –±—Ä–æ–Ω—å –Ω–∞ —Å–µ–≥–æ–¥–Ω—è",
        reply_markup=ReplyKeyboardMarkup(
            keyboard=[[KeyboardButton(text="–°–µ–≥–æ–¥–Ω—è")]],  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–±–æ—Ä–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –¥–∞—Ç—ã
            resize_keyboard=True
        )
    )


@dp.message(Booking.date)
async def booking_date(message: Message, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ Booking.date.
    –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–°–µ–≥–æ–¥–Ω—è" - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É, –∏–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—É—é –¥–∞—Ç—É.
    –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –≤—ã–±–æ—Ä—É –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–∞—Ç–∞ –∏–ª–∏ "–°–µ–≥–æ–¥–Ω—è")
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    """
    # –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–°–µ–≥–æ–¥–Ω—è" - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
    if message.text == "–°–µ–≥–æ–¥–Ω—è":
        date = datetime.now().strftime("%Y-%m-%d")  # –§–æ—Ä–º–∞—Ç: "2025-01-15"
    else:
        # –ò–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–≤–µ–¥–µ–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –¥–∞—Ç—É
        date = message.text

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞—Ç—É –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM
    await state.update_data(date=date)
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É - –≤—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞
    await state.set_state(Booking.time_from)

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤—Ä–µ–º–µ–Ω–∞–º–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞:", reply_markup=time_keyboard())


@dp.message(Booking.time_from)
async def booking_time_from(message: Message, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ Booking.time_from.
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ –≤—ã–±–æ—Ä—É –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –≤—Ä–µ–º–µ–Ω–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "14:00")
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    """
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM
    await state.update_data(time_from=message.text)
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É - –≤—ã–±–æ—Ä –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    await state.set_state(Booking.time_to)

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:", reply_markup=duration_keyboard())


@dp.message(Booking.time_to)
async def booking_time_to(message: Message, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ Booking.time_to.
    –í—ã—á–∏—Å–ª—è–µ—Ç –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ü–ö, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, "3 —á–∞—Å–∞")
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    """
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM
    data = await state.get_data()

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞ ("3 —á–∞—Å–∞" -> 3)
    hours = int(message.text.split()[0])
    # –ü–∞—Ä—Å–∏–º –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    start = datetime.strptime(data["time_from"], "%H:%M")
    # –í—ã—á–∏—Å–ª—è–µ–º –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è: –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ + –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
    end_time = (start + timedelta(hours=hours)).strftime("%H:%M")

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ü–ö –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
    available = await is_pc_available(
        pc=data["pc"],           # –ù–æ–º–µ—Ä –ü–ö
        date=data["date"],       # –î–∞—Ç–∞
        time_from=data["time_from"],  # –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
        time_to=end_time         # –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
    )

    # –ï—Å–ª–∏ –ü–ö –∑–∞–Ω—è—Ç - —Å–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
    if not available:
        await state.clear()  # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM
        await message.answer("‚ùå –ü–ö –∑–∞–Ω—è—Ç –Ω–∞ —ç—Ç–æ –≤—Ä–µ–º—è", reply_markup=main_menu())
        return

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å –¥–µ—Ç–∞–ª—è–º–∏ –±—Ä–æ–Ω–∏
    confirmation_text = (
        f"üìã –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:\n\n"
        f"üñ• –ü–ö: {data['pc']}\n"
        f"üìÖ –î–∞—Ç–∞: {data['date']}\n"
        f"‚è∞ –í—Ä–µ–º—è: {data['time_from']} ‚Äì {end_time}\n\n"
        f"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å?"
    )

    # –°–æ–∑–¥–∞–µ–º inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏ –æ—Ç–º–µ–Ω—ã
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        # –ö–Ω–æ–ø–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (callback_data —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
        [InlineKeyboardButton(text="‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å", callback_data=f"confirm_{data['pc']}_{data['date']}_{data['time_from']}_{end_time}")],
        # –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã
        [InlineKeyboardButton(text="‚ùå –û—Ç–º–µ–Ω–∏—Ç—å", callback_data="cancel_booking")]
    ])

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM
    await state.update_data(time_to=end_time)
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏
    await message.answer(confirmation_text, reply_markup=keyboard)


@dp.callback_query(F.data.startswith("confirm_"))
async def confirm_booking(callback: CallbackQuery, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å".
    –°–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω—å –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–ª—É–±–∞,
    —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç ID –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
    
    Args:
        callback: –û–±—ä–µ–∫—Ç callback –æ—Ç –Ω–∞–∂–∞—Ç–∏—è inline –∫–Ω–æ–ø–∫–∏
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM —Å –¥–∞–Ω–Ω—ã–º–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    """
    # –ò–°–ü–†–ê–í–õ–ï–ù–û: –°—Ä–∞–∑—É –æ—Ç–≤–µ—á–∞–µ–º –Ω–∞ callback query, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ç–∞–π–º–∞—É—Ç–∞
    # Telegram —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ–∫—É–Ω–¥, –∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –∑–∞–Ω–∏–º–∞—Ç—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    await callback.answer("‚è≥ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...")
    
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM
    data = await state.get_data()
    
    # –ò–°–ü–†–ê–í–õ–ï–ù–û: –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –≤ FSM, –∏–∑–≤–ª–µ–∫–∞–µ–º –∏—Ö –∏–∑ callback_data
    # –§–æ—Ä–º–∞—Ç callback_data: "confirm_{pc}_{date}_{time_from}_{time_to}"
    if not data or "pc" not in data:
        # –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏–∑ callback_data
        callback_parts = callback.data.replace("confirm_", "").split("_")
        if len(callback_parts) >= 4:
            data = {
                "pc": int(callback_parts[0]),
                "date": callback_parts[1],
                "time_from": callback_parts[2],
                "time_to": callback_parts[3]
            }
        else:
            # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å - —Å–æ–æ–±—â–∞–µ–º –æ–± –æ—à–∏–±–∫–µ
            await callback.message.edit_text("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞—á–Ω–∏—Ç–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–Ω–æ–≤–æ.")
            await state.clear()
            return
    
    # –®–∞–≥ 1: –°–æ–∑–¥–∞–µ–º –±—Ä–æ–Ω—å –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
    try:
        await add_booking(
            user_id=callback.from_user.id,  # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
            pc=data["pc"],                   # –ù–æ–º–µ—Ä –ü–ö
            date=data["date"],               # –î–∞—Ç–∞
            time_from=data["time_from"],     # –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
            time_to=data["time_to"]          # –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
        )
    except KeyError as e:
        # –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ
        logger.error(f"–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –≤ –¥–∞–Ω–Ω—ã—Ö: {e}")
        await callback.message.edit_text("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞—á–Ω–∏—Ç–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–Ω–æ–≤–æ.")
        await state.clear()
        return
    
    # –ü–æ–ª—É—á–∞–µ–º ID —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –±—Ä–æ–Ω–∏ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
    booking = await get_last_booking(callback.from_user.id)
    local_booking_id = booking[0] if booking else None

    # –®–∞–≥ 2: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –±—Ä–æ–Ω—å –≤ API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–ª—É–±–∞
    api_result = None
    try:
        # –ò–°–ü–†–ê–í–õ–ï–ù–û: –ù–µ —Å–æ–∑–¥–∞–µ–º –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π email, –ø–µ—Ä–µ–¥–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
        # API —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π email –∏–ª–∏ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É, –∞ "username@telegram" –Ω–µ–≤–∞–ª–∏–¥–µ–Ω
        contact_email = ""  # –ù–µ –ø–µ—Ä–µ–¥–∞–µ–º email, —Ç–∞–∫ –∫–∞–∫ —Ñ–æ—Ä–º–∞—Ç @telegram –Ω–µ–≤–∞–ª–∏–¥–µ–Ω
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST –∑–∞–ø—Ä–æ—Å –≤ API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±—Ä–æ–Ω–∏
        api_result = await api_client.create_booking(
            telegram_user_id=callback.from_user.id,  # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
            pc_number=data["pc"],                     # –ù–æ–º–µ—Ä –ü–ö
            date=data["date"],                        # –î–∞—Ç–∞
            time_from=data["time_from"],              # –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
            time_to=data["time_to"],                  # –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
            contact_phone="",                         # –¢–µ–ª–µ—Ñ–æ–Ω (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
            contact_email=contact_email               # Email (–ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
        )
        
        # –®–∞–≥ 3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º ID - —Å–æ—Ö—Ä–∞–Ω—è–µ–º api_booking_id –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
        if api_result and local_booking_id:
            api_booking_id = api_result.get("id")  # –ò–∑–≤–ª–µ–∫–∞–µ–º ID –∏–∑ –æ—Ç–≤–µ—Ç–∞ API
            if api_booking_id:
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º api_booking_id –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ API)
                await update_booking_api_id(local_booking_id, api_booking_id)
                logger.info(f"–ë—Ä–æ–Ω—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞: local_id={local_booking_id}, api_id={api_booking_id}")
    except Exception as e:
        # –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ API - –ª–æ–≥–∏—Ä—É–µ–º, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É
        # –ë—Ä–æ–Ω—å —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î, –±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –±—Ä–æ–Ω–∏ –≤ API: {e}")

    # –®–∞–≥ 4: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –æ –Ω–æ–≤–æ–π –±—Ä–æ–Ω–∏
    await send_to_admin(
        "üì¢ –ù–æ–≤–∞—è –±—Ä–æ–Ω—å!\n\n"
        f"üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @{callback.from_user.username or callback.from_user.full_name}\n"
        f"üñ• –ü–ö: {data['pc']}\n"
        f"üìÖ –î–∞—Ç–∞: {data['date']}\n"
        f"‚è∞ –í—Ä–µ–º—è: {data['time_from']} ‚Äì {data['time_to']}"
    )

    # –®–∞–≥ 5: –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM (–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ)
    await state.clear()
    
    # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º (—É–±–∏—Ä–∞–µ–º –∫–Ω–æ–ø–∫–∏, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
    # –ò–°–ü–†–ê–í–õ–ï–ù–û: callback.answer() —É–∂–µ –≤—ã–∑–≤–∞–Ω –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏, –Ω–µ –≤—ã–∑—ã–≤–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ
    await callback.message.edit_text(
        "‚úÖ –ë—Ä–æ–Ω—å —Å–æ–∑–¥–∞–Ω–∞!\n\n"
        f"–ü–ö: {data['pc']}\n"
        f"–î–∞—Ç–∞: {data['date']}\n"
        f"–í—Ä–µ–º—è: {data['time_from']} ‚Äì {data['time_to']}"
    )

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    await callback.message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=main_menu())


@dp.callback_query(F.data == "cancel_booking")
async def cancel_booking_callback(callback: CallbackQuery, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–º–µ–Ω—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —ç—Ç–∞–ø–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å" –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏.
    –û—Ç–º–µ–Ω—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–µ —Å–æ–∑–¥–∞–≤–∞—è –±—Ä–æ–Ω—å.
    
    Args:
        callback: –û–±—ä–µ–∫—Ç callback –æ—Ç –Ω–∞–∂–∞—Ç–∏—è inline –∫–Ω–æ–ø–∫–∏
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM (–æ—á–∏—â–∞–µ—Ç—Å—è)
    """
    # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM (–æ—Ç–º–µ–Ω—è–µ–º –ø—Ä–æ—Ü–µ—Å—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
    await state.clear()
    # –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ
    await callback.message.edit_text("‚ùå –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ")
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    await callback.answer("–û—Ç–º–µ–Ω–µ–Ω–æ")

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    await callback.message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=main_menu())


@dp.message(F.text == "üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞")
async def support_start(message: Message, state: FSMContext):
    """
    –ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.
    
    –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM –≤ Support.message.
    –ë–æ—Ç –±—É–¥–µ—Ç –æ–∂–∏–¥–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞"
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
    """
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM: —Ç–µ–ø–µ—Ä—å –±–æ—Ç –æ–∂–∏–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    await state.set_state(Support.message)
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–æ–π –æ—Ç–º–µ–Ω—ã
    await message.answer(
        "üí¨ –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏:",
        reply_markup=ReplyKeyboardMarkup(
            keyboard=[[KeyboardButton(text="‚ùå –û—Ç–º–µ–Ω–∞")]],  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–º–µ–Ω—ã
            resize_keyboard=True
        )
    )


@dp.message(Support.message)
async def support_message(message: Message, state: FSMContext):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ Support.message –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.
    –ü–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞/–ø—Ä–æ–±–ª–µ–º—ã)
        state: –ö–æ–Ω—Ç–µ–∫—Å—Ç FSM
    """
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É –æ—Ç–º–µ–Ω—ã - –æ—Ç–º–µ–Ω—è–µ–º –ø—Ä–æ—Ü–µ—Å—Å
    if message.text == "‚ùå –û—Ç–º–µ–Ω–∞":
        await state.clear()
        await message.answer("–û—Ç–º–µ–Ω–µ–Ω–æ", reply_markup=main_menu())
        return

    # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º username –µ—Å–ª–∏ –µ—Å—Ç—å, –∏–Ω–∞—á–µ –∏–º—è –∏ ID
    user_info = f"@{message.from_user.username}" if message.from_user.username else f"{message.from_user.full_name} (ID: {message.from_user.id})"

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    await send_to_admin(
        f"üí¨ –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É\n\n"
        f"üë§ –û—Ç: {user_info}\n"
        f"üìù –°–æ–æ–±—â–µ–Ω–∏–µ:\n{message.text}"
    )

    # –û—á–∏—â–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM
    await state.clear()
    # –°–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
    await message.answer(
        "‚úÖ –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É. –ú—ã –æ—Ç–≤–µ—Ç–∏–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è!",
        reply_markup=main_menu()
    )


@dp.message(F.text == "üìã –ú–æ–∏ –±—Ä–æ–Ω–∏")
async def my_bookings(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±—Ä–æ–Ω–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
    –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –±—Ä–æ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö —Å–ø–∏—Å–∫–æ–º.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üìã –ú–æ–∏ –±—Ä–æ–Ω–∏"
    """
    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –±—Ä–æ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
    bookings = await get_user_bookings(message.from_user.id)

    # –ï—Å–ª–∏ –±—Ä–æ–Ω–µ–π –Ω–µ—Ç - —Å–æ–æ–±—â–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    if not bookings:
        await message.answer("üìã –£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –±—Ä–æ–Ω–µ–π", reply_markup=main_menu())
        return

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ —Å–ø–∏—Å–∫–æ–º –±—Ä–æ–Ω–µ–π
    text = "üìã –í–∞—à–∏ –±—Ä–æ–Ω–∏:\n\n"
    for booking in bookings:
        # –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –±—Ä–æ–Ω–∏: id, –Ω–æ–º–µ—Ä –ü–ö, –¥–∞—Ç–∞, –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞, –≤—Ä–µ–º—è –∫–æ–Ω—Ü–∞, api_booking_id
        booking_id, pc, date, time_from, time_to, api_booking_id = booking
        # –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±—Ä–æ–Ω–∏ –≤ —Ç–µ–∫—Å—Ç
        text += f"üñ• –ü–ö {pc}\n"
        text += f"üìÖ {date}\n"
        text += f"‚è∞ {time_from} ‚Äì {time_to}\n"
        text += "‚îÄ" * 20 + "\n"  # –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –º–µ–∂–¥—É –±—Ä–æ–Ω—è–º–∏

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –±—Ä–æ–Ω–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    await message.answer(text, reply_markup=main_menu())


@dp.message(F.text == "‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è")
async def info_menu_handler(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–∑–¥–µ–ª–∞ "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è".
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é —Å –ø–æ–¥—Ä–∞–∑–¥–µ–ª–∞–º–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–ø—Ä–∞–π—Å, –∞–∫—Ü–∏–∏, —Ç—É—Ä–Ω–∏—Ä—ã, –ø—Ä–∞–≤–∏–ª–∞).
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
    """
    await message.answer("‚ÑπÔ∏è –í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:", reply_markup=info_menu())


@dp.message(F.text == "üí∞ –ü—Ä–∞–π—Å-–ª–∏—Å—Ç")
async def price_list(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞.
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–µ–Ω—ã –Ω–∞ –≤—Å–µ –∑–æ–Ω—ã (Standart, Bootcamp, VIP, PlayStation)
    —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –±—É–¥–Ω—è–º/–≤—ã—Ö–æ–¥–Ω—ã–º –∏ –¥–Ω—é/–Ω–æ—á–∏.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üí∞ –ü—Ä–∞–π—Å-–ª–∏—Å—Ç"
    """
    # –°–ª–æ–≤–∞—Ä—å —Å —Ü–µ–Ω–∞–º–∏ –¥–ª—è –≤—Å–µ—Ö –∑–æ–Ω –∏ –ø–µ—Ä–∏–æ–¥–æ–≤
    prices = {
        "Standart": {
            "–±—É–¥–Ω–∏": {
                "–¥–µ–Ω—å": {"1 —á–∞—Å": 110, "3 —á–∞—Å–∞": 300, "5 —á–∞—Å–æ–≤": 470, "7 —á–∞—Å–æ–≤": 600, "—É—Ç—Ä–æ": 260, "–Ω–æ—á—å": 500},
                "–Ω–æ—á—å": {"1 —á–∞—Å": 120, "3 —á–∞—Å–∞": 320, "5 —á–∞—Å–æ–≤": 510, "7 —á–∞—Å–æ–≤": 670, "—É—Ç—Ä–æ": 260, "–Ω–æ—á—å": 500}
            },
            "–≤—ã—Ö–æ–¥–Ω—ã–µ": {
                "–¥–µ–Ω—å": {"1 —á–∞—Å": 120, "3 —á–∞—Å–∞": 320, "5 —á–∞—Å–æ–≤": 510, "7 —á–∞—Å–æ–≤": 670, "—É—Ç—Ä–æ": 310, "–Ω–æ—á—å": 550},
                "–Ω–æ—á—å": {"1 —á–∞—Å": 130, "3 —á–∞—Å–∞": 350, "5 —á–∞—Å–æ–≤": 550, "7 —á–∞—Å–æ–≤": 730, "—É—Ç—Ä–æ": 310, "–Ω–æ—á—å": 550}
            }
        },
        "Bootcamp": {
            "–±—É–¥–Ω–∏": {
                "–¥–µ–Ω—å": {"1 —á–∞—Å": 120, "3 —á–∞—Å–∞": 320, "5 —á–∞—Å–æ–≤": 510, "7 —á–∞—Å–æ–≤": 670, "—É—Ç—Ä–æ": 320, "–Ω–æ—á—å": 600},
                "–Ω–æ—á—å": {"1 —á–∞—Å": 130, "3 —á–∞—Å–∞": 350, "5 —á–∞—Å–æ–≤": 550, "7 —á–∞—Å–æ–≤": 730, "—É—Ç—Ä–æ": 320, "–Ω–æ—á—å": 600}
            },
            "–≤—ã—Ö–æ–¥–Ω—ã–µ": {
                "–¥–µ–Ω—å": {"1 —á–∞—Å": 130, "3 —á–∞—Å–∞": 350, "5 —á–∞—Å–æ–≤": 550, "7 —á–∞—Å–æ–≤": 730, "—É—Ç—Ä–æ": 370, "–Ω–æ—á—å": 650},
                "–Ω–æ—á—å": {"1 —á–∞—Å": 140, "3 —á–∞—Å–∞": 380, "5 —á–∞—Å–æ–≤": 590, "7 —á–∞—Å–æ–≤": 780, "—É—Ç—Ä–æ": 370, "–Ω–æ—á—å": 650}
            }
        },
        "VIP": {
            "–±—É–¥–Ω–∏": {
                "–¥–µ–Ω—å": {"1 —á–∞—Å": 130, "3 —á–∞—Å–∞": 350, "5 —á–∞—Å–æ–≤": 550, "7 —á–∞—Å–æ–≤": 730, "—É—Ç—Ä–æ": 400, "–Ω–æ—á—å": 710},
                "–Ω–æ—á—å": {"1 —á–∞—Å": 140, "3 —á–∞—Å–∞": 380, "5 —á–∞—Å–æ–≤": 590, "7 —á–∞—Å–æ–≤": 780, "—É—Ç—Ä–æ": 400, "–Ω–æ—á—å": 710}
            },
            "–≤—ã—Ö–æ–¥–Ω—ã–µ": {
                "–¥–µ–Ω—å": {"1 —á–∞—Å": 140, "3 —á–∞—Å–∞": 380, "5 —á–∞—Å–æ–≤": 590, "7 —á–∞—Å–æ–≤": 780, "—É—Ç—Ä–æ": 450, "–Ω–æ—á—å": 760},
                "–Ω–æ—á—å": {"1 —á–∞—Å": 150, "3 —á–∞—Å–∞": 410, "5 —á–∞—Å–æ–≤": 640, "7 —á–∞—Å–æ–≤": 840, "—É—Ç—Ä–æ": 450, "–Ω–æ—á—å": 760}
            }
        },
        "PlayStation": {
            "Standart": {"1 —á–∞—Å": 250, "3 —á–∞—Å–∞": 600, "5 —á–∞—Å–æ–≤": 900, "–Ω–æ—á—å": 1200},
            "VIP": {"1 —á–∞—Å": 300, "3 —á–∞—Å–∞": 750, "5 —á–∞—Å–æ–≤": 1100, "–Ω–æ—á—å": 1500}
        }
    }

    # –ò–∫–æ–Ω–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–æ–Ω—ã
    zone_icons = {"Standart": "üñ•", "Bootcamp": "üíª", "VIP": "‚≠ê", "PlayStation": "üéÆ"}

    # –ù–∞—á–∏–Ω–∞–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞
    text = "üí∞ –ü—Ä–∞–π—Å-–ª–∏—Å—Ç\n\n"
    text += "‚è∞ –î–µ–Ω—å: 10:00-22:00 | –ù–æ—á—å: 22:00-10:00\n\n"

    # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤—Å–µ–º –∑–æ–Ω–∞–º –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å —Ü–µ–Ω–∞–º–∏
    for zone, periods in prices.items():
        icon = zone_icons[zone]
        text += f"{icon} {zone}\n"

        if zone == "PlayStation":
            text += "  üñ• Standart: "
            text += f"1—á-{periods['Standart']['1 —á–∞—Å']}‚ÇΩ | "
            text += f"3—á-{periods['Standart']['3 —á–∞—Å–∞']}‚ÇΩ | "
            text += f"5—á-{periods['Standart']['5 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"–Ω–æ—á—å-{periods['Standart']['–Ω–æ—á—å']}‚ÇΩ\n"
            text += "  ‚≠ê VIP: "
            text += f"1—á-{periods['VIP']['1 —á–∞—Å']}‚ÇΩ | "
            text += f"3—á-{periods['VIP']['3 —á–∞—Å–∞']}‚ÇΩ | "
            text += f"5—á-{periods['VIP']['5 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"–Ω–æ—á—å-{periods['VIP']['–Ω–æ—á—å']}‚ÇΩ\n\n"
        else:
            text += "  üìÖ –ë—É–¥–Ω–∏ - –î–µ–Ω—å: "
            text += f"1—á-{periods['–±—É–¥–Ω–∏']['–¥–µ–Ω—å']['1 —á–∞—Å']}‚ÇΩ | "
            text += f"3—á-{periods['–±—É–¥–Ω–∏']['–¥–µ–Ω—å']['3 —á–∞—Å–∞']}‚ÇΩ | "
            text += f"5—á-{periods['–±—É–¥–Ω–∏']['–¥–µ–Ω—å']['5 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"7—á-{periods['–±—É–¥–Ω–∏']['–¥–µ–Ω—å']['7 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"—É—Ç—Ä–æ-{periods['–±—É–¥–Ω–∏']['–¥–µ–Ω—å']['—É—Ç—Ä–æ']}‚ÇΩ | "
            text += f"–Ω–æ—á—å-{periods['–±—É–¥–Ω–∏']['–¥–µ–Ω—å']['–Ω–æ—á—å']}‚ÇΩ\n"
            text += "  üìÖ –ë—É–¥–Ω–∏ - –ù–æ—á—å: "
            text += f"1—á-{periods['–±—É–¥–Ω–∏']['–Ω–æ—á—å']['1 —á–∞—Å']}‚ÇΩ | "
            text += f"3—á-{periods['–±—É–¥–Ω–∏']['–Ω–æ—á—å']['3 —á–∞—Å–∞']}‚ÇΩ | "
            text += f"5—á-{periods['–±—É–¥–Ω–∏']['–Ω–æ—á—å']['5 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"7—á-{periods['–±—É–¥–Ω–∏']['–Ω–æ—á—å']['7 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"—É—Ç—Ä–æ-{periods['–±—É–¥–Ω–∏']['–Ω–æ—á—å']['—É—Ç—Ä–æ']}‚ÇΩ | "
            text += f"–Ω–æ—á—å-{periods['–±—É–¥–Ω–∏']['–Ω–æ—á—å']['–Ω–æ—á—å']}‚ÇΩ\n"
            text += "  üìÖ –í—ã—Ö–æ–¥–Ω—ã–µ - –î–µ–Ω—å: "
            text += f"1—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–¥–µ–Ω—å']['1 —á–∞—Å']}‚ÇΩ | "
            text += f"3—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–¥–µ–Ω—å']['3 —á–∞—Å–∞']}‚ÇΩ | "
            text += f"5—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–¥–µ–Ω—å']['5 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"7—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–¥–µ–Ω—å']['7 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"—É—Ç—Ä–æ-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–¥–µ–Ω—å']['—É—Ç—Ä–æ']}‚ÇΩ | "
            text += f"–Ω–æ—á—å-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–¥–µ–Ω—å']['–Ω–æ—á—å']}‚ÇΩ\n"
            text += "  üìÖ –í—ã—Ö–æ–¥–Ω—ã–µ - –ù–æ—á—å: "
            text += f"1—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–Ω–æ—á—å']['1 —á–∞—Å']}‚ÇΩ | "
            text += f"3—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–Ω–æ—á—å']['3 —á–∞—Å–∞']}‚ÇΩ | "
            text += f"5—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–Ω–æ—á—å']['5 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"7—á-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–Ω–æ—á—å']['7 —á–∞—Å–æ–≤']}‚ÇΩ | "
            text += f"—É—Ç—Ä–æ-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–Ω–æ—á—å']['—É—Ç—Ä–æ']}‚ÇΩ | "
            text += f"–Ω–æ—á—å-{periods['–≤—ã—Ö–æ–¥–Ω—ã–µ']['–Ω–æ—á—å']['–Ω–æ—á—å']}‚ÇΩ\n\n"

    await message.answer(text)


@dp.message(F.text == "üéÅ –ê–∫—Ü–∏–∏ –∏ –±–æ–Ω—É—Å—ã")
async def promotions(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–∑–¥–µ–ª–∞ "–ê–∫—Ü–∏–∏ –∏ –±–æ–Ω—É—Å—ã".
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–∫—Ü–∏—è—Ö –∏ –±–æ–Ω—É—Å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –∫–ª—É–±–∞.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üéÅ –ê–∫—Ü–∏–∏ –∏ –±–æ–Ω—É—Å—ã"
    """
    text = "üéÅ –ê–∫—Ü–∏–∏ –∏ –±–æ–Ω—É—Å—ã:\n\n"
    text += "üéâ –°–∏—Å—Ç–µ–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏, —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–∫–∏–¥–∫–∞ –Ω–∞ –≤–∞—à–µ–º –∞–∫–∫–∞—É–Ω—Ç–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–∂–Ω–æ –≤ –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏\n"
    text += "üéÆ –•2 –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ –≤–∞—à –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è"
    await message.answer(text)


@dp.message(F.text == "üèÜ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤")
async def tournament_schedule(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–∑–¥–µ–ª–∞ "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤".
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤ –≤ –∫–ª—É–±–µ.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üèÜ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤"
    """
    text = "üèÜ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤:\n\n"
    text += "üìÖ –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫: CS2 —Ç—É—Ä–Ω–∏—Ä (14:00)\n\n"
    text += "üîó –î–ª—è –∑–∞–ø–∏—Å–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª '–°—Å—ã–ª–∫–∏'"
    await message.answer(text)


@dp.message(F.text == "üìú –ü—Ä–∞–≤–∏–ª–∞ –∫–ª—É–±–∞")
async def club_rules(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–∑–¥–µ–ª–∞ "–ü—Ä–∞–≤–∏–ª–∞ –∫–ª—É–±–∞".
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –≤ –∫–ª—É–±–µ.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üìú –ü—Ä–∞–≤–∏–ª–∞ –∫–ª—É–±–∞"
    """
    text = "üìú –ü—Ä–∞–≤–∏–ª–∞ –∫–ª—É–±–∞:\n\n"
    text += "1. –°–æ–±–ª—é–¥–∞–π—Ç–µ —Ç–∏—à–∏–Ω—É –∏ –ø–æ—Ä—è–¥–æ–∫\n"
    text += "2. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∫—É—Ä–µ–Ω–∏–µ –∏ —Ä–∞—Å–ø–∏—Ç–∏–µ –∞–ª–∫–æ–≥–æ–ª—å–Ω–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏\n"
    text += "3. –ë–µ—Ä–µ–∂–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ—Å—å –∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é\n"
    text += "4. –ë—Ä–æ–Ω—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ 20 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –≤—Ä–µ–º–µ–Ω–∏\n"
    text += "5. –ü—Ä–∏ –æ–ø–æ–∑–¥–∞–Ω–∏–∏ –±–æ–ª–µ–µ 20 –º–∏–Ω—É—Ç –±—Ä–æ–Ω—å –∞–Ω–Ω—É–ª–∏—Ä—É–µ—Ç—Å—è\n"
    await message.answer(text)


@dp.message(F.text == "‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é")
async def back_to_main(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "‚¨ÖÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"
    """
    await message.answer("–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu())


@dp.message(F.text == "üîó –°—Å—ã–ª–∫–∏")
async def links_handler(message: Message):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–∞–∑–¥–µ–ª–∞ "–°—Å—ã–ª–∫–∏".
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç inline –∫–Ω–æ–ø–∫–∏ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –í–ö, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —á–∞—Ç —Ç—É—Ä–Ω–∏—Ä–æ–≤.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–µ–∫—Å—Ç–æ–º "üîó –°—Å—ã–ª–∫–∏"
    """
    await message.answer("üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:", reply_markup=links_menu())


@dp.message(F.text == "/admin_info")
async def admin_info(message: Message):
    """
    –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–µ.
    
    –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ ADMIN_ID.
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–æ–º–∞–Ω–¥–æ–π "/admin_info"
    """
    # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
    if message.from_user.id == ADMIN_ID:
        await message.answer(
            f"‚úÖ –í—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!\n"
            f"–í–∞—à ID: {ADMIN_ID}\n"
            f"–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ."
        )
    else:
        # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ ID –∏ ID –∞–¥–º–∏–Ω–∞
        await message.answer(
            f"–í–∞—à ID: {message.from_user.id}\n"
            f"ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: {ADMIN_ID}"
        )


async def main():
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞.
    
    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ polling
    (–±–æ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Telegram).
    """
    try:
        # –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        print("üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
        await init_db()  # –°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
        print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞")

        # –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
        print("üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞...")
        # start_polling - –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ polling (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –æ–ø—Ä–æ—Å —Å–µ—Ä–≤–µ—Ä–æ–≤ Telegram)
        # –ë–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
        await dp.start_polling(bot)
    except TelegramConflictError:
        # –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ - –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±–æ—Ç–∞
        print("\n‚ùå –û–®–ò–ë–ö–ê: –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±–æ—Ç–∞!")
        print("Telegram API –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É —ç–∫–∑–µ–º–ø–ª—è—Ä—É –ø–æ–ª—É—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.")
        print("\nüìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:")
        print("1. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Python:")
        print("   Get-Process python | Where-Object {$_.Path -like '*CyberZonaRND_bot*'}")
        print("2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∫—Ä–æ–º–µ –æ–¥–Ω–æ–≥–æ:")
        print("   Stop-Process -Id <ID_–ø—Ä–æ—Ü–µ—Å—Å–∞> -Force")
        print("3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞")
        print("\nüí° –°–æ–≤–µ—Ç: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –∑–∞–ø—É—â–µ–Ω –ª–∏ –±–æ—Ç –≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∏–ª–∏ IDE")
        raise
    except KeyboardInterrupt:
        # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª Ctrl+C - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞
        print("\n‚èπÔ∏è –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        # –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ - –≤—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞: {e}")
        print(f"–¢–∏–ø –æ—à–∏–±–∫–∏: {type(e).__name__}")
        import traceback
        traceback.print_exc()  # –í—ã–≤–æ–¥–∏–º –ø–æ–ª–Ω—ã–π traceback –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        raise
    finally:
        # –≠—Ç–æ—Ç –±–ª–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞, –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º API –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ (–æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã)
        await api_client.close()


if __name__ == "__main__":
    """
    –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É.
    
    –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ñ–∞–π–ª –∑–∞–ø—É—â–µ–Ω –Ω–∞–ø—Ä—è–º—É—é (–Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω).
    –ó–∞–ø—É—Å–∫–∞–µ—Ç –≥–ª–∞–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é main() –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ.
    """
    try:
        # –ó–∞–ø—É—Å–∫–∞–µ–º –≥–ª–∞–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
        # asyncio.run() —Å–æ–∑–¥–∞–µ—Ç event loop –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é
        asyncio.run(main())
    except KeyboardInterrupt:
        # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª Ctrl+C - –≤—ã–≤–æ–¥–∏–º –ø—Ä–æ—â–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        print("\nüëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
    except Exception as e:
        # –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ - –≤—ã–≤–æ–¥–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        print(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        # –û–∂–∏–¥–∞–µ–º –Ω–∞–∂–∞—Ç–∏—è Enter –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º (—á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–µ–ª –æ—à–∏–±–∫—É)
        input("–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")